.TH LUMOS-SEQUENCE 5
'\"
'\" LUMOS DOCUMENTATION: LUMOS-SEQUENCE
'\" $Header: /tmp/cvsroot/lumos/man/man5/lumos-sequence.5,v 1.3 2008-12-30 22:58:02 steve Exp $
'\"
'\" Lumos Light Orchestration System
'\" Copyright Â© 2005-2008, 2011 by Steven L. Willoughby, Aloha,
'\" Oregon, USA.  All Rights Reserved.  Licensed under the Open Software
'\" License version 3.0.
'\"
'\" This product is provided for educational, experimental or personal
'\" interest use, in accordance with the terms and conditions of the
'\" aforementioned license agreement, ON AN "AS IS" BASIS AND WITHOUT
'\" WARRANTY, EITHER EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION,
'\" THE WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A
'\" PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL
'\" WORK IS WITH YOU.  (See the license agreement for full details, 
'\" including disclaimer of warranty and limitation of liability.)
'\"
'\" Under no curcumstances is this product intended to be used where the
'\" safety of any person, animal, or property depends upon, or is at
'\" risk of any kind from, the correct operation of this software or
'\" the hardware devices which it controls.
'\"
'\" USE THIS PRODUCT AT YOUR OWN RISK.
'\" 
.SH NAME
Lumos Sequence File \- script for light displays run by Lumos
.SH SYNOPSIS
.LP
.BI V3, comments
.br
.BI U, id , channels...
.br
\&...
.br
.BI T, timestamp
.br
.BI E, unit , channel , value , interval
.br
\&...
.SH DESCRIPTION
.LP
The Lumos light orchestration system plays pre-programmed sequences
of light channel patterns.  This document explains the format of the ASCII
file which is read by Lumos to load these sequences prior to executing them.
.LP
The overall file format is standard CSV (comma-separated value).
This allows you to edit the file using a spreadsheet program
(e.g., OpenOffice Calc*, GNU Gnumeric*, or Microsoft Office Excel*) if that's 
preferred, so long as you save the file into CSV format.
.LP
Specifically:
.TP 
(1)
The file is organized into a sequential collection of records,
each describing a single aspect of a sequence.
Each record is stored on a single line of the file
(terminated by a carriage-return and linefeed).
.TP 
(2)
Each record is further divided into \*(lqfields\*(rq, separated
from one another by commas 
.RB ( , ).
.TP 
(3)
If a data field itself contains one or more commas, it must be
enclosed in double quote characters 
.RB ( \(dq ).  
Surrounding other
data fields in quotes is permitted but not required.
.TP
(4)
Literal double-quote characters inside a quoted field are
specified by doubling them
.RB ( \(dq\(dq ),
for example:
.RS
.B "U,\(dqThe\(dq\(dqX10\(dq\(dqController\(dq,1,5,7"
.RE
.TP
(5)
A newline may appear inside a quoted field.  That field, including
the newline, continues on the next line of the file.  This is discouraged
and not guaranteed to be supported in future versions.
.TP
(6)
All data in the file should be printable ASCII characters.
.TP
(7)
Blank space around commas should
.I not
be included in the file unless you intend for the field
contents to include those spaces as part of the data
field.
.SS Comments
.LP
This file format does not support comments other than
as described for the initial record (See the \*(lqV\*(rq
record type description below).
.SS "Record Types"
.LP
The first field of every record specifies the record's type, and may have one of 
the following values:
.TP
.B A
Audio track.  This record describes the audio to be played with the sequence, if any.
If there is no audio, this record should not appear in the file at all. The following
fields occur after the record type field.  Any of them may be left empty to take
the default value.  If not all fields are present at all, defaults are assumed for
the remaining missing fields to the end of the record.
.RS
.TP 10
.I filename
The name of the audio file.  The pathname should be written such that the player
program can locate it (e.g., if it is a pathname relative to a certain directory,
that should be the current directory from the point of view of the player process).
The file may be in any audio format supported by PyGame, but safe options include
WAV and OGG.  If maximum platform compatibility is desired, OGG would be a good choice.
.TP
.I volume
The playback volume, as a percentage from 0 (quiet) to 100 (full volume).  
[Default: 100]
.TP
.I channels
The number of audio channels to use.  Should be 1 for mono or 2 for stereo.
[Default: 2]
.TP
.I frequency
The sample frequency in Hz. 
[Default: 44100]
.TP
.I bits
The number of bits per sample.  Negative values indicate signed data (e.g., \-12 would mean 12-bit signed values), while positive ones indicate unsigned data (e.g., 8 would mean 8-bit unsigned data).
[Default: \-16]
.TP
.I buffer
The buffer size to maintain for playback, which should be a power of 2.
[Default: 4096]
.RE
.TP
.B E
Event.  This record describes a channel value change event.  This includes 
four more fields, as follows:
.RS
.TP
.I u
The controller unit index, as an integer value (0 being the controller described
by the first 
.B U
record encountered in the file, 1 being the next, etc.) or the special value
.RB \*(lq * \*(rq
which means the event applies to 
.I all
controllers in the system.
.TP
.I ch
The channel index, as an integer value (0 being the first channel listed for
this controller in the corresponding
.B U
record, 1 being the next channel listed, etc.; these may not be the same
as the device's channel numbers if not all channels are being used), or the
special value
.RB \*(lq * \*(rq
which means the event applies to
.I all
channels of this controller.  If the unit index for this event was
.RB \*(lq * \*(rq,
then the channel must also be
.RB \*(lq * \*(rq.
.TP
.I v
The value to change the channel to, as a floating-point percentage, where 0
represents fully off, and 100 represents fully on.  Device channels incapable
of dimming should be set to 0 or 100, although it is generally the case that
any value greater than 0 is considered \*(lqon\*(rq for such devices.
.TP
.I dT
The amount of time over which the transition to the value
.I v
is to be made.  If an instant change is required, this value would be 0.
This is an integer value measured in milliseconds.
.RE
.TP
.B T
Timestamp.  The next field is an (integer) number of milliseconds measured from the
start of the sequence.  All event records listed after this point will occur at
that time in the sequence.  These do not need to appear in chronological order,
and in fact a later
.B T
record may duplicate the time value of a previous one (in which case their events
will be merged and all take place at that time in the sequence).
.TP
.B U
Controller unit declaration.  The next field is the ID tag for a controller unit
used in this sequence.  Following this are one or more fields giving the ID tags
for each channel used in this sequence.  This record must appear before any event
record referencing this controller unit.
.TP
.BI V n
This must be the first record in the sequence.  The number
.I n
specifies what version of this format is being used for this file.  This document
describes version 3.
The remainder of the record is ignored.
.SH EXAMPLE
.LP
A file which controls channel C7 of the controller called \*(lqfloods\*(rq,
and four channels (0, 1, 2, and 3) of the controller called \*(lqtree\*(rq,
which ramps up the floods over 2 seconds, then at 7s in drops them to half
brightness; sequences each tree channel for 1s each in turn, then ramps each
up from off to on in 1s each and holds them there, then at 00:00:10.000 fades
everything to black over a 1s period, would look like this:
.RS
.na
.nf
V3,Lumos sequence file,test.lseq
A,test.ogg,100
U,floods,C7
U,tree,0,1,2,3
T,0
E,*,*,0,0
T,1000
E,0,0,100,2000
E,1,0,100,0
T,2000
E,1,0,0,0
E,1,1,100,0
T,3000
E,1,1,0,0
E,1,2,100,0
T,4000
E,1,2,0,0
E,1,3,100,0
T,5000
E,1,0,100,1000
T,6000
E,1,1,100,1000
T,7000
E,1,2,100,1000
E,0,0,50,0
T,8000
E,1,3,100,1000
T,10000
E,*,*,0,1000
.fi
.ad
.RE
.SH VERSION
.LP
This documents the Lumos sequence file version 3, for the Lumos software version 0.4.
.SH COPYRIGHT
.LP
Lumos Light Orchestration System,
Copyright \(co 2005\-2008, 2011 by Steven L. Willoughby, Aloha,
Oregon, USA.  All Rights Reserved.  Licensed under the Open Software
License version 3.0.  See the
.B LICENSE
file accompanying the Lumos software distribution for full terms
and conditions of use, disclaimer of warranty, limitation of liability
and other information, or see:
.br
http://www.opensource.org/licenses/osl-3.0.php.
.SH AUTHOR
.LP
Steve Willoughby / steve@alchemy.com
.SH HISTORY
.LP
Version 1 file format created 6 September 2005 for Lumos 0.1.  This version is deprecated and
no longer supported by Lumos (this was never in a released version of the software).
.br
Version 2 file format created 25 September 2008.  This differed from V3 files only in that
it did not include an \*(lqA\*(rq (audio) record type.
.br
Version 3 file format created 29 November 2011 (described here).
.SH BUGS
.LP
We still need to work out a more sophisticated repeat block protocol.
'\" 
'\" $Log: not supported by cvs2svn $
'\" 
