'\"************************************************************************
'\"************************************************************************
'\"************************************************************************
'\"
'\" This file has been processed by automated scripts.  DO NOT EDIT this
'\" file directly or your edits will be lost!  
'\"
'\" Edit the corresponding <entry>.<section>.in file instead.
'\"
'\"************************************************************************
'\"************************************************************************
'\"************************************************************************
.TH LUMOS-CHANNEL-MAP 5
'\"
'\" LUMOS DOCUMENTATION:
'\"
'\" Lumos Light Orchestration System
'\" Copyright (c) 2005-2009, 2011, 2012, 2013 by Steven L. Willoughy, Aloha, OR, USA.
'\" All Rights Reserved.  Licensed under the terms and conditions of the
'\" Open Software License version 3.0.
'\"
'\" This product is provided for educational, experimental or personal
'\" interest use, in accordance with the terms and conditions of the
'\" aforementioned license agreement, ON AN "AS IS" BASIS AND WITHOUT
'\" WARRANTY, EITHER EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION,
'\" THE WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A
'\" PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL
'\" WORK IS WITH YOU.  (See the license agreement for full details, 
'\" including disclaimer of warranty and limitation of liability.)
'\"
'\" Under no curcumstances is this product intended to be used where the
'\" safety of any person, animal, or property depends upon, or is at
'\" risk of any kind from, the correct operation of this software or
'\" the hardware devices which it controls.
'\"
'\" USE THIS PRODUCT AT YOUR OWN RISK.
'\" 
.SH NAME
Lumos Channel Map File \- Assignment of Vixen Channels to Lumos Channels
.SH SYNOPSIS
.LP
.B #Comment
.br
.IB CMV , 2 , comments...
.br
.IB idx , name , channelname \fR[\fP, subchannel\fR]\fP
.SH DESCRIPTION
.LP
This document describes the format of files used by Lumos to define
mappings between channels referenced by external sequence sources
(e.g., Vixen sequence files) and Lumos channels used by a particular
show.
.LP
The overall file format is standard CSV (comma-separated value).
This allows you to edit the file using a spreadsheet program
(e.g., OpenOffice Calc*, GNU Gnumeric*, or Microsoft Office Excel*) if that's 
preferred, so long as you save the file into CSV format.  Specific details
about the CSV file format as used here are provided below under
.RB \*(lq "CSV FILE FORMAT" .\*(rq
.LP
Each line in the file is a \*(lqrecord\*(rq which describes a discrete bit of
information of interest.  Records are themselves composed of \*(lqfields\*(rq
which are separated from each other by commas.
.SS Comments
.LP
Any record whose first field begins with a 
.B #
character is assumed to be a comment, and the entire record
is ignored.  Be aware, however, that all the rules
for the CSV file format must still be adhered to.
.SS "Version Declaration"
.LP
The first non-comment record in the file
.I must
be a version declaration record.  The first field has the constant value
.RB \*(lq CMV \*(rq.
The second field contains an integer which indicates the format version
this file uses.  This document describes version 2, so for all files used
with Lumos as of this writing, the version declaration record should read
.RB \*(lq CMV,2 \*(rq.
If the version number is 1 (or no 
.B CMV
record exists at all), file format version 1 is assumed.  See the historical
notes below for what that version entailed.  New files should only be written
in the most recent file format supported by Lumos.
.LP
Any fields after the second are ignored completely, and may be used as comments.
.SS Mappings
.LP
A mapping record describes a single assignment of an external
(e.g., Vixen) output channel to a single Lumos channel, in this format:
.LP
.RS
.IB idx , name , channelname
.RE
or
.RS
.IB idx , name , channelname , subchannel
.RE
.LP
The source (Vixen) channel is specified in the first two fields, which 
are:
.TP 13
.I idx
The index number of the channel.  The first channel appearing in the
sequence file is number 0, the next is 1, and so on.
.TP
.I name
The text name of the channel as displayed in the Vixen sequence editing grid.
.LP
If you generate this file via 
.BR vixen2lumos (1)
with the
.B \-\-genmap
option, both
.I idx
and
.I name
fields will be filled in.  However, it is permitted for one of these to 
be empty.  If only
.I idx
is given, whatever channel is in that position in the sequence file will 
be used.  If 
.I name
is given, the channel with that name is found.  If both are used, they must
both apply (i.e., the named channel must be at that index position in the file).
.LP
The same source channel may not be mapped more than one time, however multiple
source channels may be mapped to the same destination channel (merging
their events so any action taken on either of the original channels
affects the same Lumos channel).
.LP
The destination channel is specified by the third and (optionally) fourth fields:
.TP 13
.I channelname
The name of the virtual channel as known to the Lumos sequence editor, defined
in the Lumos
show configuration file.
.TP
.I subchannel
If the channel is of a type which includes multiple control points (such as 
an RGB light with separate red, green, and blue controls), and the Vixen sequence
treats each of those control points as a separate channel, you need to indicate
how those separate Vixen channels map to the components of the more complex Lumos
virtual channel.  For example, if Vixen channels 4, 5, and 6 correspond to the
red, green, and blue components of an RGB light known to Lumos as the virtual channel
\*(lqflood16\*(rq, the mapping lines would look like this:
.RS
.RS
.na
.nf
.B 4,,flood16,0
.B 5,,flood16,1
.B 6,,flood16,2
.ad
.fi
.RE
.LP
The particular association of subchannels depends upon the type of virtual channel,
and is in fact interpreted by the appropriate virtual channel object class within
Lumos.  The standard virtual channel types as of this writing are:
.RS
.TP
.B dimmer
Dimmers do not have subchannels.
.TP
.B rgb
These have three hardware channels, one for each primary color to be mixed.  For
the lumos channel map file, use subchannel number 
.B 0
for red,
.B 1
for green, and
.B 2
for blue.
.TP
.B toggle
Toggles do not have subchannels.
.RE
.RE
.SH "CSV FILE FORMAT"
.LP
The specific dialect of comma-separated value (CSV) file used by
this program follows these rules:
.TP 
(1)
The file is organized into a sequential collection of records,
each describing a single \*(lqmapping\*(rq or \*(lqcomment\*(rq
(q.v.).  Each record is stored on a single line of the file
(terminated by a carriage-return and linefeed).
.TP 
(2)
Each record is further divided into \*(lqfields\*(rq, separated
from one another by commas 
.RB ( , ).
.TP 
(3)
If a data field itself contains one or more commas, it must be
enclosed in double quote characters 
.RB ( \(dq ).  
Surrounding other
data fields in quotes is permitted but not required.
.TP
(4)
Literal double-quote characters inside a quoted field are
specified by doubling them
.RB ( \(dq\(dq ),
for example:
.RS
.B "12,\(dqChannel \(dq\(dqX\(dq\(dq...\(dq,a,0"
.RE
.TP
(5)
A newline may appear inside a quoted field.  That field, including
the newline, continues on the next line of the file.  This is discouraged
and not guaranteed to be supported in future versions.
.TP
(6)
All data in the file should be printable ASCII characters.
.TP
(7)
Blank space around commas should
.I not
be included in the file unless you intend for the field
contents to include those spaces as part of the data
field.
.SH EXAMPLE
.LP
A mapping from the first three Vixen channels (called
\*(lqA\*(rq, \*(lqB\*(rq, and \*(lqC\*(rq) to, respectively,
Lumos controller channels \*(lqfloods12,\*(rq \*(lqtrees1,\*(rq and \*(lqtrees2\*(rq
would look like this:
.LP
.RS
.nf
.na
# Lumos map file for my show
0,A,floods12
1,B,trees1
2,C,trees2
.ad
.fi
.RE
.LP
If the index positions of these were not known, the names alone
could be used:
.LP
.RS
.nf
.na
# Lumos map file for my show
,A,floods12
,B,trees1
,C,trees2
.ad
.fi
.RE
.SH VERSION
.LP
This documents the Lumos mapping file version 1, for software version 0.6.1.
.SH "SEE ALSO"
.LP
.BR lumos (1),
.BR lumos-sequence (5),
.BR vixen2lumos (1).
.SH COPYRIGHT
.LP
Lumos Light Orchestration System,
Copyright \(co 2005\-2009, 2011, 2012, 2013 by Steven L. Willoughy, Aloha, OR, USA.
All Rights Reserved.  Licensed under the terms and conditions of the
Open Software License version 3.0.  See the
.B LICENSE
file accompanying the Lumos software distribution for full terms and
conditions of use, disclaimer of warranty, limitation of liability
and other information, or see:
.br
http://www.opensource.org/licenses/osl-3.0.php.
.SH AUTHOR
.LP
Steve Willoughby / steve@alchemy.com
.SH HISTORY
.LP
This file format first appeared for
.B vixen2lumos
as part of the Lumos 0.3 software release.
.LP
Version 2 of this file, documented here, appeared in Lumos version 1.0
.SS "File Format Version 1"
.LP
Older mapping file formats (version 1) did not support the concept of virtual
channels but rather mapped Vixen channels to Lumos hardware channels.  In that
version, the mapping records had the form
.RS
.IB idx , name , controller , channel
.RE
where
.I controller
and
.I channel
were the names defined in the Lumos show configuration file for a particular
controller and channel.
.SH NOTES
.LP
*Names of third-party products or organizations are the property of their respective owners and may be trademarks owned by them.
